# SuperSlides Progress Report â€” February 12, 2026

## Overview

Today's session introduced a new table formatting workflow centered on swapping table structure content without manual cut/paste. We implemented row and column swap operations, added an optional formatting-preservation mode, expanded the sidebar UI, fixed a runtime merge-state error, and updated feature documentation.

---

## 1. New Table Swap Features

### Swap Rows in Table
- **Function:** `swapTableRows(rowA, rowB, keepFormatting)`
- **Purpose:** Swap two rows in a selected table using 1-based indices from the sidebar
- **Validation:**
  - Validates row indices are whole numbers
  - Validates indices are within table bounds
  - Returns no-op if both indices are the same

### Swap Columns in Table
- **Function:** `swapTableColumns(colA, colB, keepFormatting)`
- **Purpose:** Swap two columns in a selected table using 1-based indices
- **Validation:**
  - Validates column indices are whole numbers
  - Validates indices are within table bounds
  - Returns no-op if both indices are the same

---

## 2. New Swap Modes

### Default Mode (Formatting Checkbox OFF)
- Swaps plain text values only
- Destination cell retains its existing formatting context
- Behavior is intentionally simple and fast

### Preserve Formatting Mode (Formatting Checkbox ON)
- Swaps content with source formatting payload
- Includes:
  - Text run styles (font, size, color, emphasis, links, etc.)
  - Paragraph styles (line spacing, spacing, indents, paragraph alignment)
  - Cell fill
  - Cell content alignment

---

## 3. Sidebar UI Enhancements

### New Buttons
- `Swap Rows in Table`
- `Swap Columns in Table`

### New Modal
- Reused modal for both row and column operations
- Dynamic labels based on selected mode
- Inputs:
  - First index (1-based)
  - Second index (1-based)
  - `Keep source text style + cell formatting (fill/alignment)` checkbox

### New Client Handlers
- `showTableSwapDialog(mode)`
- `hideTableSwapDialog()`
- `runTableSwap()`

---

## 4. Table Resolution + Error Handling

### Table Resolution
Added helper logic to resolve the target table safely:
1. Use exactly one selected table if present
2. Else use the only table on current slide (if exactly one exists)
3. Else return explicit user error

### Input / State Safeguards
- Validates index inputs on client and server
- Blocks merged-cell swaps with explicit message
- Returns clear status strings for success and failure

---

## 5. Bug Fix: Merge-State Runtime Error

### Issue
- Runtime error observed:
  - `TypeError: Cannot read properties of undefined (reading 'NORMAL')`

### Root Cause
- Merge-state check referenced `SlidesApp.MergeState.NORMAL`, which is not reliable in this Apps Script surface.

### Fix
- Replaced enum dependency with safe string-based merge-state normalization in `isMergedCell_()`.

---

## 6. Documentation Updates

### Updated `FEATURES.md`
- Added new sections:
  - `Swap Rows in Table`
  - `Swap Columns in Table`
- Updated:
  - Table of contents
  - API reference (server + client functions)
  - Known limitations with a dedicated table swap subsection

---

## 7. Current Known Limitations

- Border transfer during row/column swap is not supported in the current Apps Script implementation.
- Merged-cell swaps are intentionally blocked.
- Formatting-preservation mode targets text/paragraph/cell fill/content-alignment scope.

---

## Files Modified Today

- `src/Code.gs`
- `src/Sidebar.html`
- `FEATURES.md`
- `progress-2026-02-12.md` (new)
